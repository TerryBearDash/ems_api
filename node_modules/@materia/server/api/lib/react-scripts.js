"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const path = require("path");
const fs = require("fs");
const execa = require("execa");
class ReactScripts {
    constructor(app) {
        this.app = app;
    }
    exec(command, params) {
        return new Promise((resolve, reject) => {
            let data = '';
            let stream = null;
            if (fs.existsSync(path.join(this.app.path, 'node_modules', '.bin', 'react-scripts'))) {
                stream = execa(path.join(this.app.path, 'node_modules', '.bin', 'react-scripts'), [command, ...params], {
                    cwd: this.app.path
                });
            } /*else {
                stream = execa(path.join(path.resolve(), `resources/node_modules/.bin/npm`), [command, ...params], {
                    cwd: this.app.path
                });
            }*/
            stream.stdout.on('data', d => {
                data += d;
            });
            stream.stderr.on('data', (d) => {
                data += d;
            });
            stream.on('close', (code) => {
                if (code == 0) {
                    return resolve(data);
                }
                else {
                    return reject({
                        code,
                        data
                    });
                }
            });
        });
    }
}
exports.ReactScripts = ReactScripts;
//# sourceMappingURL=react-scripts.js.map