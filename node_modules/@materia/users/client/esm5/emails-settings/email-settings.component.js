/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes} checked by tsc
 */
import { Component, Input, Output, EventEmitter, ViewChild } from '@angular/core';
import { HttpClient } from '@angular/common/http';
import { FormBuilder, Validators } from '@angular/forms';
import { MatExpansionPanel } from '@angular/material';
var EmailSettingsComponent = /** @class */ (function () {
    function EmailSettingsComponent(http, form) {
        this.http = http;
        this.form = form;
        this.hide = new EventEmitter();
        this.save = new EventEmitter();
    }
    /**
     * @param {?} property
     * @param {?} defaultValue
     * @return {?}
     */
    EmailSettingsComponent.prototype.getSettingsProperty = /**
     * @param {?} property
     * @param {?} defaultValue
     * @return {?}
     */
    function (property, defaultValue) {
        return (this.settings && this.settings[property]) || defaultValue;
    };
    /**
     * @return {?}
     */
    EmailSettingsComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        this.emailForm = this.form.group({
            method: [
                this.getSettingsProperty('method', 'session'),
                Validators.required
            ],
            static_salt: [
                this.getSettingsProperty('static_salt', ''),
                Validators.required
            ],
            user_profile_enabled: [
                this.getSettingsProperty('user_profile_enabled', 'false')
            ],
            user_profile_entity: [
                this.getSettingsProperty('user_profile_entity', '')
            ],
            email_verification: [
                this.getSettingsProperty('email_verification', false)
            ],
            email_addon: [this.getSettingsProperty('email_addon', false)],
            template_signup: [this.getSettingsProperty('template_signup', '')],
            redirect_signup: [this.getSettingsProperty('redirect_signup', '')],
            subject_signup: [this.getSettingsProperty('subject_signup', '')],
            subject_lost_password: [this.getSettingsProperty('subject_lost_password', '')],
            subject_change_email: [this.getSettingsProperty('subject_change_email', '')],
            template_lost_password: [
                this.getSettingsProperty('template_lost_password', '')
            ],
            redirect_lost_password: [
                this.getSettingsProperty('redirect_lost_password', '')
            ],
            template_change_email: [
                this.getSettingsProperty('template_change_email', '')
            ],
            redirect_change_email: [
                this.getSettingsProperty('redirect_change_email', '')
            ]
        });
        this.refreshTemplates();
    };
    /**
     * @return {?}
     */
    EmailSettingsComponent.prototype.refreshTemplates = /**
     * @return {?}
     */
    function () {
        var _this = this;
        if (this.settings.email_addon === '@materia/mailjet') {
            this.http
                .post(this.baseUrl + "/entities/mailjet_template/queries/list", { limit: 1000 })
                .subscribe(function (data) {
                _this.templates = data.data
                    .filter(function (row) { return row.OwnerId !== 1; })
                    .map(function (row) {
                    return {
                        name: row.Name,
                        id: row.ID
                    };
                });
            });
        }
        else if (this.settings.email_addon === '@materia/sendgrid') {
            this.http
                .post(this.baseUrl + "/entities/sendgrid_template/queries/listTemplates", {})
                .subscribe(function (data) {
                _this.templates = data && data.data && data.data;
                // TODO...
            });
        }
    };
    /**
     * @return {?}
     */
    EmailSettingsComponent.prototype.saveEmailSettings = /**
     * @return {?}
     */
    function () {
        if (this.emailForm.valid) {
            this.save.emit(this.emailForm.value);
        }
    };
    /**
     * @return {?}
     */
    EmailSettingsComponent.prototype.cancel = /**
     * @return {?}
     */
    function () {
        this.hide.emit();
    };
    EmailSettingsComponent.decorators = [
        { type: Component, args: [{
                    selector: 'materia-user-management-email-settings',
                    template: "<form [formGroup]=\"emailForm\">\n\t<mat-accordion>\n\t\t<mat-expansion-panel #signupPanel [expanded]=\"true\" fxLayout=\"column\">\n\t\t\t<mat-expansion-panel-header>\n\t\t\t\tSignup\n\t\t\t</mat-expansion-panel-header>\n\n\t\t\t<div class=\"panel-content\" fxLayout=\"column\">\n\t\t\t\t<mat-form-field>\n\t\t\t\t\t<input matInput placeholder=\"Subject\" formControlName=\"subject_signup\">\n\t\t\t\t</mat-form-field>\n\n\t\t\t\t<mat-form-field>\n\t\t\t\t\t<mat-select placeholder=\"Template\" formControlName=\"template_signup\">\n\t\t\t\t\t\t<mat-option *ngFor=\"let t of templates\" [value]=\"t.id\">{{ t.name }} ({{t.id}})</mat-option>\n\t\t\t\t\t</mat-select>\n\t\t\t\t</mat-form-field>\n\t\t\t\t<mat-form-field>\n\t\t\t\t\t<input matInput placeholder=\"Redirect URL\" formControlName=\"redirect_signup\">\n\t\t\t\t</mat-form-field>\n\t\t\t</div>\n\t\t</mat-expansion-panel>\n\n\t\t<mat-expansion-panel #changeEmailPanel>\n\t\t\t<mat-expansion-panel-header>\n\t\t\t\tChange email\n\t\t\t</mat-expansion-panel-header>\n\n\t\t\t<div class=\"panel-content\" fxLayout=\"column\">\n\t\t\t\t<mat-form-field>\n\t\t\t\t\t<input matInput placeholder=\"Subject\" formControlName=\"subject_change_email\">\n\t\t\t\t</mat-form-field>\n\n\t\t\t\t<mat-form-field>\n\t\t\t\t\t<mat-select placeholder=\"Template\" formControlName=\"template_change_email\">\n\t\t\t\t\t\t<mat-option *ngFor=\"let t of templates\" [value]=\"t.id\">{{ t.name }} ({{t.id}})</mat-option>\n\t\t\t\t\t</mat-select>\n\t\t\t\t</mat-form-field>\n\t\t\t\t<mat-form-field>\n\t\t\t\t\t<input matInput placeholder=\"Redirect URL\" formControlName=\"redirect_change_email\">\n\t\t\t\t</mat-form-field>\n\t\t\t</div>\n\t\t</mat-expansion-panel>\n\n\t\t<mat-expansion-panel #lostPasswordPanel fxLayout=\"column\">\n\t\t\t<mat-expansion-panel-header>\n\t\t\t\tLost password\n\t\t\t</mat-expansion-panel-header>\n\t\t\t<div class=\"panel-content\" fxLayout=\"column\">\n\n\t\t\t\t<mat-form-field>\n\t\t\t\t\t<input matInput placeholder=\"Subject\" formControlName=\"subject_lost_password\">\n\t\t\t\t</mat-form-field>\n\t\t\t\t<mat-form-field>\n\t\t\t\t\t<mat-select placeholder=\"Template\" formControlName=\"template_lost_password\">\n\t\t\t\t\t\t<mat-option *ngFor=\"let t of templates\" [value]=\"t.id\">{{ t.name }} ({{t.id}})</mat-option>\n\t\t\t\t\t</mat-select>\n\t\t\t\t</mat-form-field>\n\t\t\t\t<mat-form-field>\n\t\t\t\t\t<input matInput placeholder=\"Redirect URL\" formControlName=\"redirect_lost_password\">\n\t\t\t\t</mat-form-field>\n\t\t\t</div>\n\t\t</mat-expansion-panel>\n\t</mat-accordion>\n\t<div style=\"margin: 16px 0; text-align: center;\">\n\t\t<button mat-raised-button color=\"primary\" (click)=\"saveEmailSettings()\" style=\"margin-right: 8px\">Save</button>\n\t\t<button mat-raised-button (click)=\"hide.emit()\">Cancel</button>\n\t</div>\n</form>",
                    styles: [".panel-content{margin:0 24px!important}"]
                },] },
    ];
    /** @nocollapse */
    EmailSettingsComponent.ctorParameters = function () { return [
        { type: HttpClient, },
        { type: FormBuilder, },
    ]; };
    EmailSettingsComponent.propDecorators = {
        "settings": [{ type: Input },],
        "baseUrl": [{ type: Input },],
        "hide": [{ type: Output },],
        "save": [{ type: Output },],
        "signupPanel": [{ type: ViewChild, args: ['signupPanel',] },],
        "changeEmailPanel": [{ type: ViewChild, args: ['changeEmailPanel',] },],
        "lostPasswordPanel": [{ type: ViewChild, args: ['lostPasswordPanel',] },],
    };
    return EmailSettingsComponent;
}());
export { EmailSettingsComponent };
function EmailSettingsComponent_tsickle_Closure_declarations() {
    /** @type {!Array<{type: !Function, args: (undefined|!Array<?>)}>} */
    EmailSettingsComponent.decorators;
    /**
     * @nocollapse
     * @type {function(): !Array<(null|{type: ?, decorators: (undefined|!Array<{type: !Function, args: (undefined|!Array<?>)}>)})>}
     */
    EmailSettingsComponent.ctorParameters;
    /** @type {!Object<string,!Array<{type: !Function, args: (undefined|!Array<?>)}>>} */
    EmailSettingsComponent.propDecorators;
    /** @type {?} */
    EmailSettingsComponent.prototype.settings;
    /** @type {?} */
    EmailSettingsComponent.prototype.baseUrl;
    /** @type {?} */
    EmailSettingsComponent.prototype.emailForm;
    /** @type {?} */
    EmailSettingsComponent.prototype.templates;
    /** @type {?} */
    EmailSettingsComponent.prototype.hide;
    /** @type {?} */
    EmailSettingsComponent.prototype.save;
    /** @type {?} */
    EmailSettingsComponent.prototype.signupPanel;
    /** @type {?} */
    EmailSettingsComponent.prototype.changeEmailPanel;
    /** @type {?} */
    EmailSettingsComponent.prototype.lostPasswordPanel;
    /** @type {?} */
    EmailSettingsComponent.prototype.http;
    /** @type {?} */
    EmailSettingsComponent.prototype.form;
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZW1haWwtc2V0dGluZ3MuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6Im5nOi8vQG1hdGVyaWEvdXNlcnMvIiwic291cmNlcyI6WyJlbWFpbHMtc2V0dGluZ3MvZW1haWwtc2V0dGluZ3MuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7QUFBQSxPQUFPLEVBQ0wsU0FBUyxFQUVULEtBQUssRUFDTCxNQUFNLEVBQ04sWUFBWSxFQUNaLFNBQVMsRUFDVixNQUFNLGVBQWUsQ0FBQztBQUN2QixPQUFPLEVBQUUsVUFBVSxFQUFFLE1BQU0sc0JBQXNCLENBQUM7QUFDbEQsT0FBTyxFQUFhLFdBQVcsRUFBRSxVQUFVLEVBQUUsTUFBTSxnQkFBZ0IsQ0FBQztBQUNwRSxPQUFPLEVBQUUsaUJBQWlCLEVBQUUsTUFBTSxtQkFBbUIsQ0FBQzs7SUFnR3BELGdDQUFvQixJQUFnQixFQUFVLElBQWlCO1FBQTNDLFNBQUksR0FBSixJQUFJLENBQVk7UUFBVSxTQUFJLEdBQUosSUFBSSxDQUFhO29CQVh4RCxJQUFJLFlBQVksRUFBUTtvQkFFeEIsSUFBSSxZQUFZLEVBQU87S0FTcUM7Ozs7OztJQUUzRCxvREFBbUI7Ozs7O2NBQUMsUUFBUSxFQUFFLFlBQVk7UUFDaEQsTUFBTSxDQUFDLENBQUMsSUFBSSxDQUFDLFFBQVEsSUFBSSxJQUFJLENBQUMsUUFBUSxDQUFDLFFBQVEsQ0FBQyxDQUFDLElBQUksWUFBWSxDQUFDOzs7OztJQUVwRSx5Q0FBUTs7O0lBQVI7UUFDRSxJQUFJLENBQUMsU0FBUyxHQUFHLElBQUksQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDO1lBQy9CLE1BQU0sRUFBRTtnQkFDTixJQUFJLENBQUMsbUJBQW1CLENBQUMsUUFBUSxFQUFFLFNBQVMsQ0FBQztnQkFDN0MsVUFBVSxDQUFDLFFBQVE7YUFDcEI7WUFDRCxXQUFXLEVBQUU7Z0JBQ1gsSUFBSSxDQUFDLG1CQUFtQixDQUFDLGFBQWEsRUFBRSxFQUFFLENBQUM7Z0JBQzNDLFVB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OztJQUNELGtEQUFpQjs7O0lBQWpCO1FBQ0UsRUFBRSxDQUFDLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDO1lBQ3pCLElBQUksQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUMsS0FBSyxDQUFDLENBQUM7U0FDdEM7S0FDRjs7OztJQUNELHVDQUFNOzs7SUFBTjtRQUNFLElBQUksQ0FBQyxJQUFJLENBQUMsSUFBSSxFQUFFLENBQUM7S0FDbEI7O2dCQTlLRixTQUFTLFNBQUM7b0JBQ1QsUUFBUSxFQUFFLHdDQUF3QztvQkFDbEQsUUFBUSxFQUFFLG94RkFvRUo7b0JBQ04sTUFBTSxFQUFFLENBQUMseUNBQXlDLENBQUM7aUJBQ3BEOzs7O2dCQTVFUSxVQUFVO2dCQUNDLFdBQVc7Ozs2QkE2RTVCLEtBQUs7NEJBRUwsS0FBSzt5QkFNTCxNQUFNO3lCQUVOLE1BQU07Z0NBR04sU0FBUyxTQUFDLGFBQWE7cUNBRXZCLFNBQVMsU0FBQyxrQkFBa0I7c0NBRTVCLFNBQVMsU0FBQyxtQkFBbUI7O2lDQXZHaEM7O1NBcUZhLHNCQUFzQiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XG4gIENvbXBvbmVudCxcbiAgT25Jbml0LFxuICBJbnB1dCxcbiAgT3V0cHV0LFxuICBFdmVudEVtaXR0ZXIsXG4gIFZpZXdDaGlsZFxufSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IEh0dHBDbGllbnQgfSBmcm9tICdAYW5ndWxhci9jb21tb24vaHR0cCc7XG5pbXBvcnQgeyBGb3JtR3JvdXAsIEZvcm1CdWlsZGVyLCBWYWxpZGF0b3JzIH0gZnJvbSAnQGFuZ3VsYXIvZm9ybXMnO1xuaW1wb3J0IHsgTWF0RXhwYW5zaW9uUGFuZWwgfSBmcm9tICdAYW5ndWxhci9tYXRlcmlhbCc7XG5cbkBDb21wb25lbnQoe1xuICBzZWxlY3RvcjogJ21hdGVyaWEtdXNlci1tYW5hZ2VtZW50LWVtYWlsLXNldHRpbmdzJyxcbiAgdGVtcGxhdGU6IGA8Zm9ybSBbZm9ybUdyb3VwXT1cImVtYWlsRm9ybVwiPlxuXHQ8bWF0LWFjY29yZGlvbj5cblx0XHQ8bWF0LWV4cGFuc2lvbi1wYW5lbCAjc2lnbnVwUGFuZWwgW2V4cGFuZGVkXT1cInRydWVcIiBmeExheW91dD1cImNvbHVtblwiPlxuXHRcdFx0PG1hdC1leHBhbnNpb24tcGFuZWwtaGVhZGVyPlxuXHRcdFx0XHRTaWdudXBcblx0XHRcdDwvbWF0LWV4cGFuc2lvbi1wYW5lbC1oZWFkZXI+XG5cblx0XHRcdDxkaXYgY2xhc3M9XCJwYW5lbC1jb250ZW50XCIgZnhMYXlvdXQ9XCJjb2x1bW5cIj5cblx0XHRcdFx0PG1hdC1mb3JtLWZpZWxkPlxuXHRcdFx0XHRcdDxpbnB1dCBtYXRJbnB1dCBwbGFjZWhvbGRlcj1cIlN1YmplY3RcIiBmb3JtQ29udHJvbE5hbWU9XCJzdWJqZWN0X3NpZ251cFwiPlxuXHRcdFx0XHQ8L21hdC1mb3JtLWZpZWxkPlxuXG5cdFx0XHRcdDxtYXQtZm9ybS1maWVsZD5cblx0XHRcdFx0XHQ8bWF0LXNlbGVjdCBwbGFjZWhvbGRlcj1cIlRlbXBsYXRlXCIgZm9ybUNvbnRyb2xOYW1lPVwidGVtcGxhdGVfc2lnbnVwXCI+XG5cdFx0XHRcdFx0XHQ8bWF0LW9wdGlvbiAqbmdGb3I9XCJsZXQgdCBvZiB0ZW1wbGF0ZXNcIiBbdmFsdWVdPVwidC5pZFwiPnt7IHQubmFtZSB9fSAoe3t0LmlkfX0pPC9tYXQtb3B0aW9uPlxuXHRcdFx0XHRcdDwvbWF0LXNlbGVjdD5cblx0XHRcdFx0PC9tYXQtZm9ybS1maWVsZD5cblx0XHRcdFx0PG1hdC1mb3JtLWZpZWxkPlxuXHRcdFx0XHRcdDxpbnB1dCBtYXRJbnB1dCBwbGFjZWhvbGRlcj1cIlJlZGlyZWN0IFVSTFwiIGZvcm1Db250cm9sTmFtZT1cInJlZGlyZWN0X3NpZ251cFwiPlxuXHRcdFx0XHQ8L21hdC1mb3JtLWZpZWxkPlxuXHRcdFx0PC9kaXY+XG5cdFx0PC9tYXQtZXhwYW5zaW9uLXBhbmVsPlxuXG5cdFx0PG1hdC1leHBhbnNpb24tcGFuZWwgI2NoYW5nZUVtYWlsUGFuZWw+XG5cdFx0XHQ8bWF0LWV4cGFuc2lvbi1wYW5lbC1oZWFkZXI+XG5cdFx0XHRcdENoYW5nZSBlbWFpbFxuXHRcdFx0PC9tYXQtZXhwYW5zaW9uLXBhbmVsLWhlYWRlcj5cblxuXHRcdFx0PGRpdiBjbGFzcz1cInBhbmVsLWNvbnRlbnRcIiBmeExheW91dD1cImNvbHVtblwiPlxuXHRcdFx0XHQ8bWF0LWZvcm0tZmllbGQ+XG5cdFx0XHRcdFx0PGlucHV0IG1hdElucHV0IHBsYWNlaG9sZGVyPVwiU3ViamVjdFwiIGZvcm1Db250cm9sTmFtZT1cInN1YmplY3RfY2hhbmdlX2VtYWlsXCI+XG5cdFx0XHRcdDwvbWF0LWZvcm0tZmllbGQ+XG5cblx0XHRcdFx0PG1hdC1mb3JtLWZpZWxkPlxuXHRcdFx0XHRcdDxtYXQtc2VsZWN0IHBsYWNlaG9sZGVyPVwiVGVtcGxhdGVcIiBmb3JtQ29udHJvbE5hbWU9XCJ0ZW1wbGF0ZV9jaGFuZ2VfZW1haWxcIj5cblx0XHRcdFx0XHRcdDxtYXQtb3B0aW9uICpuZ0Zvcj1cImxldCB0IG9mIHRlbXBsYXRlc1wiIFt2YWx1ZV09XCJ0LmlkXCI+e3sgdC5uYW1lIH19ICh7e3QuaWR9fSk8L21hdC1vcHRpb24+XG5cdFx0XHRcdFx0PC9tYXQtc2VsZWN0PlxuXHRcdFx0XHQ8L21hdC1mb3JtLWZpZWxkPlxuXHRcdFx0XHQ8bWF0LWZvcm0tZmllbGQ+XG5cdFx0XHRcdFx0PGlucHV0IG1hdElucHV0IHBsYWNlaG9sZGVyPVwiUmVkaXJlY3QgVVJMXCIgZm9ybUNvbnRyb2xOYW1lPVwicmVkaXJlY3RfY2hhbmdlX2VtYWlsXCI+XG5cdFx0XHRcdDwvbWF0LWZvcm0tZmllbGQ+XG5cdFx0XHQ8L2Rpdj5cblx0XHQ8L21hdC1leHBhbnNpb24tcGFuZWw+XG5cblx0XHQ8bWF0LWV4cGFuc2lvbi1wYW5lbCAjbG9zdFBhc3N3b3JkUGFuZWwgZnhMYXlvdXQ9XCJjb2x1bW5cIj5cblx0XHRcdDxtYXQtZXhwYW5zaW9uLXBhbmVsLWhlYWRlcj5cblx0XHRcdFx0TG9zdCBwYXNzd29yZFxuXHRcdFx0PC9tYXQtZXhwYW5zaW9uLXBhbmVsLWhlYWRlcj5cblx0XHRcdDxkaXYgY2xhc3M9XCJwYW5lbC1jb250ZW50XCIgZnhMYXlvdXQ9XCJjb2x1bW5cIj5cblxuXHRcdFx0XHQ8bWF0LWZvcm0tZmllbGQ+XG5cdFx0XHRcdFx0PGlucHV0IG1hdElucHV0IHBsYWNlaG9sZGVyPVwiU3ViamVjdFwiIGZvcm1Db250cm9sTmFtZT1cInN1YmplY3RfbG9zdF9wYXNzd29yZFwiPlxuXHRcdFx0XHQ8L21hdC1mb3JtLWZpZWxkPlxuXHRcdFx0XHQ8bWF0LWZvcm0tZmllbGQ+XG5cdFx0XHRcdFx0PG1hdC1zZWxlY3QgcGxhY2Vob2xkZXI9XCJUZW1wbGF0ZVwiIGZvcm1Db250cm9sTmFtZT1cInRlbXBsYXRlX2xvc3RfcGFzc3dvcmRcIj5cblx0XHRcdFx0XHRcdDxtYXQtb3B0aW9uICpuZ0Zvcj1cImxldCB0IG9mIHRlbXBsYXRlc1wiIFt2YWx1ZV09XCJ0LmlkXCI+e3sgdC5uYW1lIH19ICh7e3QuaWR9fSk8L21hdC1vcHRpb24+XG5cdFx0XHRcdFx0PC9tYXQtc2VsZWN0PlxuXHRcdFx0XHQ8L21hdC1mb3JtLWZpZWxkPlxuXHRcdFx0XHQ8bWF0LWZvcm0tZmllbGQ+XG5cdFx0XHRcdFx0PGlucHV0IG1hdElucHV0IHBsYWNlaG9sZGVyPVwiUmVkaXJlY3QgVVJMXCIgZm9ybUNvbnRyb2xOYW1lPVwicmVkaXJlY3RfbG9zdF9wYXNzd29yZFwiPlxuXHRcdFx0XHQ8L21hdC1mb3JtLWZpZWxkPlxuXHRcdFx0PC9kaXY+XG5cdFx0PC9tYXQtZXhwYW5zaW9uLXBhbmVsPlxuXHQ8L21hdC1hY2NvcmRpb24+XG5cdDxkaXYgc3R5bGU9XCJtYXJnaW46IDE2cHggMDsgdGV4dC1hbGlnbjogY2VudGVyO1wiPlxuXHRcdDxidXR0b24gbWF0LXJhaXNlZC1idXR0b24gY29sb3I9XCJwcmltYXJ5XCIgKGNsaWNrKT1cInNhdmVFbWFpbFNldHRpbmdzKClcIiBzdHlsZT1cIm1hcmdpbi1yaWdodDogOHB4XCI+U2F2ZTwvYnV0dG9uPlxuXHRcdDxidXR0b24gbWF0LXJhaXNlZC1idXR0b24gKGNsaWNrKT1cImhpZGUuZW1pdCgpXCI+Q2FuY2VsPC9idXR0b24+XG5cdDwvZGl2PlxuPC9mb3JtPmAsXG4gIHN0eWxlczogW2AucGFuZWwtY29udGVudHttYXJnaW46MCAyNHB4IWltcG9ydGFudH1gXVxufSlcbmV4cG9ydCBjbGFzcyBFbWFpbFNldHRpbmdzQ29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0IHtcbiAgQElucHV0KClcbiAgc2V0dGluZ3M6IGFueTtcbiAgQElucHV0KClcbiAgYmFzZVVybDogc3RyaW5nO1xuXG4gIGVtYWlsRm9ybTogRm9ybUdyb3VwO1xuICB0ZW1wbGF0ZXM6IEFycmF5PHsgbmFtZTogc3RyaW5nOyBpZDogbnVtYmVyIH0+O1xuXG4gIEBPdXRwdXQoKVxuICBoaWRlID0gbmV3IEV2ZW50RW1pdHRlcjx2b2lkPigpO1xuICBAT3V0cHV0KClcbiAgc2F2ZSA9IG5ldyBFdmVudEVtaXR0ZXI8YW55PigpO1xuXG4gIEBWaWV3Q2hpbGQoJ3NpZ251cFBhbmVsJylcbiAgc2lnbnVwUGFuZWw6IE1hdEV4cGFuc2lvblBhbmVsO1xuICBAVmlld0NoaWxkKCdjaGFuZ2VFbWFpbFBhbmVsJylcbiAgY2hhbmdlRW1haWxQYW5lbDogTWF0RXhwYW5zaW9uUGFuZWw7XG4gIEBWaWV3Q2hpbGQoJ2xvc3RQYXNzd29yZFBhbmVsJylcbiAgbG9zdFBhc3N3b3JkUGFuZWw6IE1hdEV4cGFuc2lvblBhbmVsO1xuXG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgaHR0cDogSHR0cENsaWVudCwgcHJpdmF0ZSBmb3JtOiBGb3JtQnVpbGRlcikge31cblxuICBwcml2YXRlIGdldFNldHRpbmdzUHJvcGVydHkocHJvcGVydHksIGRlZmF1bHRWYWx1ZSkge1xuICAgIHJldHVybiAodGhpcy5zZXR0aW5ncyAmJiB0aGlzLnNldHRpbmdzW3Byb3BlcnR5XSkgfHwgZGVmYXVsdFZhbHVlO1xuICB9XG4gIG5nT25Jbml0KCk6IHZvaWQge1xuICAgIHRoaXMuZW1haWxGb3JtID0gdGhpcy5mb3JtLmdyb3VwKHtcbiAgICAgIG1ldGhvZDogW1xuICAgICAgICB0aGlzLmdldFNldHRpbmdzUHJvcGVydHkoJ21ldGhvZCcsICdzZXNzaW9uJyksXG4gICAgICAgIFZhbGlkYXRvcnMucmVxdWlyZWRcbiAgICAgIF0sXG4gICAgICBzdGF0aWNfc2FsdDogW1xuICAgICAgICB0aGlzLmdldFNldHRpbmdzUHJvcGVydHkoJ3N0YXRpY19zYWx0JywgJycpLFxuICAgICAgICBWYWxpZGF0b3JzLnJlcXVpcmVkXG4gICAgICBdLFxuICAgICAgdXNlcl9wcm9maWxlX2VuYWJsZWQ6IFtcbiAgICAgICAgdGhpcy5nZXRTZXR0aW5nc1Byb3BlcnR5KCd1c2VyX3Byb2ZpbGVfZW5hYmxlZCcsICdmYWxzZScpXG4gICAgICBdLFxuICAgICAgdXNlcl9wcm9maWxlX2VudGl0eTogW1xuICAgICAgICB0aGlzLmdldFNldHRpbmdzUHJvcGVydHkoJ3VzZXJfcHJvZmlsZV9lbnRpdHknLCAnJylcbiAgICAgIF0sXG4gICAgICBlbWFpbF92ZXJpZmljYXRpb246IFtcbiAgICAgICAgdGhpcy5nZXRTZXR0aW5nc1Byb3BlcnR5KCdlbWFpbF92ZXJpZmljYXRpb24nLCBmYWxzZSlcbiAgICAgIF0sXG4gICAgICBlbWFpbF9hZGRvbjogW3RoaXMuZ2V0U2V0dGluZ3NQcm9wZXJ0eSgnZW1haWxfYWRkb24nLCBmYWxzZSldLFxuICAgICAgdGVtcGxhdGVfc2lnbnVwOiBbdGhpcy5nZXRTZXR0aW5nc1Byb3BlcnR5KCd0ZW1wbGF0ZV9zaWdudXAnLCAnJyldLFxuICAgICAgcmVkaXJlY3Rfc2lnbnVwOiBbdGhpcy5nZXRTZXR0aW5nc1Byb3BlcnR5KCdyZWRpcmVjdF9zaWdudXAnLCAnJyldLFxuICAgICAgc3ViamVjdF9zaWdudXA6IFt0aGlzLmdldFNldHRpbmdzUHJvcGVydHkoJ3N1YmplY3Rfc2lnbnVwJywgJycpXSxcbiAgICAgIHN1YmplY3RfbG9zdF9wYXNzd29yZDogW3RoaXMuZ2V0U2V0dGluZ3NQcm9wZXJ0eSgnc3ViamVjdF9sb3N0X3Bhc3N3b3JkJywgJycpXSxcbiAgICAgIHN1YmplY3RfY2hhbmdlX2VtYWlsOiBbdGhpcy5nZXRTZXR0aW5nc1Byb3BlcnR5KCdzdWJqZWN0X2NoYW5nZV9lbWFpbCcsICcnKV0sXG4gICAgICB0ZW1wbGF0ZV9sb3N0X3Bhc3N3b3JkOiBbXG4gICAgICAgIHRoaXMuZ2V0U2V0dGluZ3NQcm9wZXJ0eSgndGVtcGxhdGVfbG9zdF9wYXNzd29yZCcsICcnKVxuICAgICAgXSxcbiAgICAgIHJlZGlyZWN0X2xvc3RfcGFzc3dvcmQ6IFtcbiAgICAgICAgdGhpcy5nZXRTZXR0aW5nc1Byb3BlcnR5KCdyZWRpcmVjdF9sb3N0X3Bhc3N3b3JkJywgJycpXG4gICAgICBdLFxuICAgICAgdGVtcGxhdGVfY2hhbmdlX2VtYWlsOiBbXG4gICAgICAgIHRoaXMuZ2V0U2V0dGluZ3NQcm9wZXJ0eSgndGVtcGxhdGVfY2hhbmdlX2VtYWlsJywgJycpXG4gICAgICBdLFxuICAgICAgcmVkaXJlY3RfY2hhbmdlX2VtYWlsOiBbXG4gICAgICAgIHRoaXMuZ2V0U2V0dGluZ3NQcm9wZXJ0eSgncmVkaXJlY3RfY2hhbmdlX2VtYWlsJywgJycpXG4gICAgICBdXG4gICAgfSk7XG5cbiAgICB0aGlzLnJlZnJlc2hUZW1wbGF0ZXMoKTtcbiAgfVxuXG4gIHJlZnJlc2hUZW1wbGF0ZXMoKSB7XG4gICAgaWYgKHRoaXMuc2V0dGluZ3MuZW1haWxfYWRkb24gPT09ICdAbWF0ZXJpYS9tYWlsamV0Jykge1xuICAgICAgdGhpcy5odHRwXG4gICAgICAgIC5wb3N0PGFueT4oYCR7dGhpcy5iYXNlVXJsfS9lbnRpdGllcy9tYWlsamV0X3RlbXBsYXRlL3F1ZXJpZXMvbGlzdGAsIHtsaW1pdDogMTAwMH0pXG4gICAgICAgIC5zdWJzY3JpYmUoZGF0YSA9PiB7XG4gICAgICAgICAgdGhpcy50ZW1wbGF0ZXMgPSBkYXRhLmRhdGFcbiAgICAgICAgICAgIC5maWx0ZXIocm93ID0+IHJvdy5Pd25lcklkICE9PSAxKVxuICAgICAgICAgICAgLm1hcChyb3cgPT4ge1xuICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIG5hbWU6IHJvdy5OYW1lLFxuICAgICAgICAgICAgICAgIGlkOiByb3cuSURcbiAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9IGVsc2UgaWYgKHRoaXMuc2V0dGluZ3MuZW1haWxfYWRkb24gPT09ICdAbWF0ZXJpYS9zZW5kZ3JpZCcpIHtcbiAgICAgIHRoaXMuaHR0cFxuICAgICAgICAucG9zdDxhbnk+KFxuICAgICAgICAgIGAke3RoaXMuYmFzZVVybH0vZW50aXRpZXMvc2VuZGdyaWRfdGVtcGxhdGUvcXVlcmllcy9saXN0VGVtcGxhdGVzYCxcbiAgICAgICAgICB7fVxuICAgICAgICApXG4gICAgICAgIC5zdWJzY3JpYmUoZGF0YSA9PiB7XG4gICAgICAgICAgdGhpcy50ZW1wbGF0ZXMgPSBkYXRhICYmIGRhdGEuZGF0YSAmJiBkYXRhLmRhdGE7XG4gICAgICAgICAgLy8gVE9ETy4uLlxuICAgICAgICB9KTtcbiAgICB9XG4gIH1cbiAgc2F2ZUVtYWlsU2V0dGluZ3MoKSB7XG4gICAgaWYgKHRoaXMuZW1haWxGb3JtLnZhbGlkKSB7XG4gICAgICB0aGlzLnNhdmUuZW1pdCh0aGlzLmVtYWlsRm9ybS52YWx1ZSk7XG4gICAgfVxuICB9XG4gIGNhbmNlbCgpIHtcbiAgICB0aGlzLmhpZGUuZW1pdCgpO1xuICB9XG59XG4iXX0=